CREATE DATABASE collegee;

USE collegee;

CREATE TABLE student (
    rollno INT PRIMARY KEY,
    name VARCHAR(50),
    marks INT NOT NULL,
    grade VARCHAR(1),
    city VARCHAR(20)
);

INSERT INTO student (rollno, name, marks, grade, city)
VALUES
(101, 'anil', 78, 'C', 'Pune'),
(102, 'bhumika', 93, 'A', 'Mumbai'),
(103, 'chetan', 85, 'B', 'Mumbai'),
(104, 'dhruv', 96, 'A', 'Delhi'),
(105, 'emanuel', 12, 'F', 'Delhi'),
(106, 'farah', 82, 'B', 'Delhi');

SELECT * FROM student;
SELECT name,marks FROM student;
SELECT city FROM student;
SELECT DISTINCT city FROM student;
SELECT * FROM student WHERE marks > 80;

SELECT *
FROM student
WHERE city = "Mumbai";

SELECT *
FROM student
WHERE marks > 80 AND city = "Delhi";

-- Operator
SELECT *
FROM student
WHERE marks + 10 > 100;

SELECT *
FROM student
WHERE marks >= 93;

SELECT * 
FROM student
WHERE marks BETWEEN 80 AND 90;

-- Note :- gurgaon is not in the database
SELECT * 
FROM student
WHERE city IN ("Delhi", "Mumbai", "Gurgaon");

SELECT * 
FROM student
WHERE city NOT IN ("Delhi", "Mumbai");

SELECT *
FROM student
LIMIT 3; -- only present 3 rows from start

SELECT *
FROM student
WHERE marks > 75
LIMIT 3;

-- ORDER BY CLAUSE
SELECT *
FROM student
ORDER BY marks ASC;

SELECT *
FROM student
ORDER BY marks DESC;

-- It gives you top 3 toppers
SELECT *
FROM student
ORDER BY marks DESC
LIMIT 3;

-- Aggregate Function
SELECT MAX(marks)
FROM student;

SELECT MIN(marks)
FROM student;

SELECT AVG(marks)
FROM student;

SELECT COUNT(name)
FROM student;

-- GROUP BY CLAUSE
SELECT city, count(name)
FROM student
GROUP BY city;

-- getting the error because name is neither aggregated nor included in the GROUP BY.
-- In SQL, every selected column must be:
-- 	either inside an aggregate function (COUNT, SUM, â€¦), or
-- 	present in the GROUP BY.
-- Your query:
-- 	SELECT city, name, COUNT(name)
-- 	FROM student
-- 	GROUP BY city;
-- Here, name violates the rule.
-- so, below code will give you error.
SELECT city, name, count(name)
FROM student
GROUP BY city;

-- below is the fixed code you may try :
SELECT city, name, count(name)
FROM student
GROUP BY city, name;

-- write a query to find avg marks in each city in ASC order.
SELECT city, AVG(marks)
FROM student
GROUP BY city
ORDER BY AVG(marks) DESC;

CREATE TABLE payment (
    customer_id INT PRIMARY KEY,
    customer VARCHAR(50),
    mode VARCHAR(20),
    city VARCHAR(50)
);

INSERT INTO payment (customer_id, customer, mode, city) VALUES
(101, 'Olivia Barrett', 'Netbanking', 'Portland'),
(102, 'Ethan Sinclair', 'Credit Card', 'Miami'),
(103, 'Maya Hernandez', 'Credit Card', 'Seattle'),
(104, 'Liam Donovan', 'Netbanking', 'Denver'),
(105, 'Sophia Nguyen', 'Credit Card', 'New Orleans'),
(106, 'Caleb Foster', 'Debit Card', 'Minneapolis'),
(107, 'Ava Patel', 'Debit Card', 'Phoenix'),
(108, 'Lucas Carter', 'Netbanking', 'Boston'),
(109, 'Isabella Martinez', 'Netbanking', 'Nashville'),
(110, 'Jackson Brooks', 'Credit Card', 'Boston');

SELECT mode, COUNT(customer)
FROM payment
GROUP BY mode;
